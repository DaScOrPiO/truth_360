<%- layout("/layouts/boilerplate2.ejs") %>
<link rel="stylesheet" href="/styles/ratings/rating.css" />

<header class="upcoming-series">
  <div class="hamburger-menu" id="hamburger">
    <i class="material-symbols-outlined icon-size hamburger-item"> menu </i>
  </div>
  <div
    id="movie-image-slider"
    class="carousel carousel-dark slide"
    data-bs-ride="carousel"
    data-bs-pause="false"
  >
    <div class="carousel-inner">
      <h1 class="top">Upcoming Series</h1>
      <% for (let i = 0; i < data1.length; i++) { %>
      <div
        class="carousel-item <%= i === 0 ? 'active' : '' %>"
        data-bs-interval="3000"
      >
        <img
          src="https://image.tmdb.org/t/p/original<%= data1[i].poster_path %>"
          class="d-block w-100 image"
          alt="..."
        />
        <div class="button-container">
          <form
            action="/addtowishlist"
            method="post"
            class="form mx-4"
            enctype="multipart/form-data"
          >
            <input
              type="text"
              class="d-none"
              name="Movie_id"
              id=""
              value="<%= data1[i].id %>"
            />
            <input
              type="text"
              class="d-none"
              name="MovieName"
              id=""
              value="<%= data1[i].name %>"
            />
            <input
              type="text"
              class="d-none"
              name="Poster_path"
              id=""
              value="<%= data1[i].poster_path%>"
            />
            <button class="button fw-bolder d-flex">
              <span class="material-symbols-outlined"> add </span>
              Wishlist
            </button>
          </form>

          <div class="form mx-4">
            <button
              class="button fw-bolder d-flex"
              data-bs-toggle="modal"
              data-bs-target="#exampleModal<%= i %>"
              data-bs-whatever="@getbootstrap"
              id="review-button<%= i %>"
            >
              <span class="material-symbols-outlined"> star </span>
              Review
            </button>

            <!-- modal for review -->
            <div
              class="modal fade"
              id="exampleModal<%= i %>"
              tabindex="-1"
              aria-labelledby="exampleModalLabel"
              aria-hidden="true"
            >
              <form
                action="/add_review"
                method="post"
                class="modal-dialog"
                enctype="multipart/form-data"
              >
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">
                      Write a review for <%= data1[i].name %>
                    </h5>
                    <button
                      type="button"
                      class="btn-close"
                      data-bs-dismiss="modal"
                      aria-label="Close"
                    ></button>
                  </div>
                  <div class="modal-body">
                    <form>
                      <div class="mb-3">
                        <label for="movie_id">Movie id</label>
                        <input
                          class="form-control"
                          type="text"
                          name="Movie_id"
                          value="<%= data1[i].id %>"
                          readonly
                          id="movie_id"
                        />
                      </div>

                      <div class="mb-3">
                        <fieldset class="starability-grow">
                          <legend>rating:</legend>
                          <input
                            type="radio"
                            id="no-rate<%= i %>"
                            class="input-no-rate"
                            name="rating"
                            value="1"
                            aria-label="No rating."
                            max="5"
                          />

                          <input
                            type="radio"
                            id="rate1<%= i %>"
                            name="rating"
                            value="1"
                            checked
                          />
                          <label for="rate1<%= i %>">1 star.</label>

                          <input
                            type="radio"
                            id="rate2<%= i %>"
                            name="rating"
                            value="2"
                          />
                          <label for="rate2<%= i %>">2 stars.</label>

                          <input
                            type="radio"
                            id="rate3<%= i %>"
                            name="rating"
                            value="3"
                          />
                          <label for="rate3<%= i %>">3 stars.</label>

                          <input
                            type="radio"
                            id="rate4<%= i %>"
                            name="rating"
                            value="4"
                          />
                          <label for="rate4<%= i %>">4 stars.</label>

                          <input
                            type="radio"
                            id="rate5<%= i %>"
                            name="rating"
                            value="5"
                          />
                          <label for="rate5<%= i %>">5 stars.</label>

                          <span class="starability-focus-ring"></span>
                        </fieldset>
                      </div>

                      <div class="mb-3">
                        <label for="message-text" class="col-form-label"
                          >Comment:</label
                        >
                        <textarea
                          class="form-control"
                          id="message-text"
                          name="comment"
                          placeholder="Enter comment"
                        ></textarea>
                      </div>
                    </form>
                  </div>
                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-danger"
                      data-bs-dismiss="modal"
                    >
                      Close
                    </button>
                    <button class="btn btn-success">Drop Review</button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
      <% } %>
    </div>
    <button
      class="carousel-control-prev"
      type="button"
      data-bs-target="#movie-image-slider"
      data-bs-slide="prev"
    >
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button
      class="carousel-control-next"
      type="button"
      data-bs-target="#movie-image-slider"
      data-bs-slide="next"
    >
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>

  <div class="search-container">
    <div class="input-group mb-3">
      <input
        type="text"
        class="form-control"
        placeholder="Search movie"
        aria-label="Recipient's username"
        aria-describedby="button-addon2"
      />
      <button class="button" type="button" id="button-addon2">Search</button>
    </div>
  </div>
</header>

<section class="trending-series py-2 px-2">
  <h1>Trending This Week</h1>
  <div class="content-container d-flex flex-wrap" id="content-container">
    <% for(let i = 0; i < trendingSeries.length; i++) {%>
    <div class="card mx-auto mb-3" style="width: 16rem">
      <img
        src="https://image.tmdb.org/t/p/original<%= data2[i].poster_path %>"
        class="card-img-top"
        alt="..."
      />
      <div class="card-body">
        <p class="card-text"><%= trendingSeries[i].overview %></p>
      </div>

      <form action="" class="card-details mb-3">
        <button class="details-button">Show details</button>
      </form>

      <div class="card-review">
        <button
          class="card-review-button d-flex justify-content-center align-items-center"
          data-bs-toggle="modal"
          data-bs-target="#series-review-modal<%= i %>"
          data-bs-whatever="@getbootstrap"
          id="review-button<%= i %>"
        >
          <span class="material-symbols-outlined"> star </span>
          Review
        </button>

        <!-- modal for review -->
        <div
          class="modal fade"
          id="series-review-modal<%= i %>"
          tabindex="-1"
          aria-labelledby="series-review"
          aria-hidden="true"
        >
          <form
            action="/add_review"
            method="post"
            class="modal-dialog"
            enctype="multipart/form-data"
          >
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="series-review">
                  Write a review for <%= data2[i].name %>
                </h5>
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="modal"
                  aria-label="Close"
                ></button>
              </div>
              <div class="modal-body">
                <form>
                  <div class="mb-3">
                    <label for="movie_id">Movie id</label>
                    <input
                      class="form-control"
                      type="text"
                      name="Movie_id"
                      value="<%= data2[i].id %>"
                      readonly
                      id="movie_id"
                    />
                  </div>

                  <div class="mb-3">
                    <fieldset class="starability-grow">
                      <legend>rating:</legend>
                      <input
                        type="radio"
                        id="series-no-rate<%= i %>"
                        class="input-no-rate"
                        name="rating"
                        value="1"
                        aria-label="No rating."
                        max="5"
                      />

                      <input
                        type="radio"
                        id="series-rate1<%= i %>"
                        name="rating"
                        value="1"
                        checked
                      />
                      <label for="series-rate1<%= i %>">1 star.</label>

                      <input
                        type="radio"
                        id="series-rate2<%= i %>"
                        name="rating"
                        value="2"
                      />
                      <label for="series-rate2<%= i %>">2 stars.</label>

                      <input
                        type="radio"
                        id="series-rate3<%= i %>"
                        name="rating"
                        value="3"
                      />
                      <label for="series-rate3<%= i %>">3 stars.</label>

                      <input
                        type="radio"
                        id="series-rate4<%= i %>"
                        name="rating"
                        value="4"
                      />
                      <label for="series-rate4<%= i %>">4 stars.</label>

                      <input
                        type="radio"
                        id="series-rate5<%= i %>"
                        name="rating"
                        value="5"
                      />
                      <label for="series-rate5<%= i %>">5 stars.</label>

                      <span class="starability-focus-ring"></span>
                    </fieldset>
                  </div>

                  <div class="mb-3">
                    <label for="message-text" class="col-form-label"
                      >Comment:</label
                    >
                    <textarea
                      class="form-control"
                      id="message-text"
                      name="comment"
                      placeholder="Enter comment"
                    ></textarea>
                  </div>
                </form>
              </div>
              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-danger"
                  data-bs-dismiss="modal"
                >
                  Close
                </button>
                <button class="btn btn-success">Drop Review</button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
    <% }%>
  </div>

  <div class="d-flex justify-content-center align-items-center w-100">
    <button class="button shadow fw-bolder" id="load-more">Load More</button>
  </div>
</section>
<script>
   const key = '<%-process.env.movieKey %>';
  const values = <%- JSON.stringify(data1) %>;
  const data2 = <%- JSON.stringify(data2) %>;
  const trendingSeries = <%- JSON.stringify(trendingSeries) %>;
  const totalItems = <%- totalItems %>;
  const items_per_page = <%- items_per_page %>;
</script>
<script src="/Javascripts/tvseries.js"></script>
<script src="/Javascripts/sliderPause.js"></script>
